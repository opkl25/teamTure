<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="team.ture.mapper.locationMapper">
	
	<select id="listTspot" resultType="tspotVO">
	
		SELECT tidx 
			, tsubject
			, tcontent
			, timg
			, region
			, tag
			, delny
			
		 FROM TSPOT
		 
		 where delny != 'Y'
		  <if test="sarchType != null and sarchType.equals('tsubject')">
          and tsubject like '%'||#{sarchValue}||'%' 
          
          </if>
          
          <if test="sarchType != null and sarchType.equals('tag')">
          
          and tag like '%'||#{sarchValue}||'%'
          
          </if>
          
		 order by tidx desc
	
	</select>
	
	<select id="detailTspot" resultType="tspotVO" parameterType="int">
		SELECT Tidx
			, tsubject
			, tcontent
			, timg
			, region
			, tag
			, delny
			
		FROM TSPOT
		WHERE tidx=#{tidx}
	
	
	</select>
	
	<update id="updateTspot" parameterType="boardVO">
    	UPDATE tspot
    	   SET tsubject = #{tsubject}
    	       ,tcontent = #{tcontent}
    	       ,timg = #{timg}
    	       ,tag = #{tag}
    	       
    	WHERE tidx = #{tidx} 
    
    </update>
	
	<insert id="insertTspot" parameterType="tspotVO">
		<![CDATA[
		INSERT INTO 
					tspot(
					
					 tidx
					,tsubject
					,tcontent
					,timg
					,tag
					
					)
					
			VALUES(
					 TIDX_SEQ.NEXTVAL
					 , #{tsubject}
					 , #{tcontent}
					 , #{timg}
					 , #{tag}
					 
		]]>	 
				
					
		
	<selectKey resultType="integer" keyProperty="tidx" order="AFTER"><!--order = AFTER BEFORE-->
		SELECT MAX(tidx) FROM tspot
	</selectKey>
		
	
	</insert>
	
</mapper>